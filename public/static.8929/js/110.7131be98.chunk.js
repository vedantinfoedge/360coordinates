"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[110],{110(e,s,a){a.r(s),a.d(s,{default:()=>o});var n=a(555),t=a(43),i=a(375),c=a(579);const o=()=>{const[e,s]=(0,t.useState)([]),[a,o]=(0,t.useState)(0),[r,l]=(0,t.useState)(1),[d,m]=(0,t.useState)(!1),[h,u]=(0,t.useState)(null),[p,g]=(0,t.useState)({}),[j,x]=(0,t.useState)(!1),[f,v]=(0,t.useState)({show:!1,message:"",type:""}),N=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;m(!0);try{const a=await fetch("".concat(i.JR).concat(i.Sn.ADMIN_MODERATION_QUEUE,"?page=").concat(e,"&limit=").concat(20),{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(!a.ok)throw new Error("Failed to fetch moderation queue");const n=await a.json();if(!n.success)throw new Error(n.message||"Failed to fetch queue");s(n.data.items||[]),o(n.data.total||0),l(e)}catch(a){console.error("Error fetching queue:",a),w("Failed to load moderation queue","error")}finally{m(!1)}};(0,t.useEffect)(()=>{N(r)},[]);const w=function(e){v({show:!0,message:e,type:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success"}),setTimeout(()=>{v({show:!1,message:"",type:""})},3e3)},y=e=>{const s=new Date-new Date(e),a=Math.floor(s/6e4),n=Math.floor(a/60),t=Math.floor(n/24);return t>0?"".concat(t," day").concat(t>1?"s":""):n>0?"".concat(n," hour").concat(n>1?"s":""):"".concat(a," minute").concat(a>1?"s":"")},b=Math.ceil(a/20),_=e=>{e>=1&&e<=b&&N(e)};return(0,c.jsxs)("div",{className:"admin-moderation-queue",children:[(0,c.jsxs)("div",{className:"moderation-header",children:[(0,c.jsx)("h1",{children:"Image Moderation Queue"}),(0,c.jsxs)("div",{className:"queue-count",children:[a," image",1!==a?"s":""," pending review"]})]}),d?(0,c.jsxs)("div",{className:"loading-container",children:[(0,c.jsx)("div",{className:"spinner"}),(0,c.jsx)("p",{children:"Loading moderation queue..."})]}):0===e.length?(0,c.jsxs)("div",{className:"empty-state",children:[(0,c.jsx)("div",{className:"empty-icon",children:"\u2705"}),(0,c.jsx)("h2",{children:"No images pending review"}),(0,c.jsx)("p",{children:"All images have been reviewed. Check back later for new submissions."})]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{className:"queue-grid",children:e.map(e=>(0,c.jsxs)("div",{className:"queue-item",children:[(0,c.jsx)("div",{className:"item-header",children:(0,c.jsxs)("div",{className:"item-info",children:[(0,c.jsxs)("span",{className:"property-id",children:["Property ID: ",e.property_id]}),(0,c.jsxs)("span",{className:"time-in-queue",children:["In queue: ",y(e.created_at)]})]})}),(0,c.jsx)("div",{className:"item-image",children:(0,c.jsx)("img",{src:e.image_url||"/placeholder-image.jpg",alt:e.original_filename||"Property image",onClick:()=>u(e),className:"thumbnail-image"})}),(0,c.jsxs)("div",{className:"item-details",children:[(0,c.jsxs)("div",{className:"reason-for-review",children:[(0,c.jsx)("strong",{children:"Reason:"})," ",e.reason_for_review||"Needs manual review"]}),e.confidence_scores&&Object.keys(e.confidence_scores).length>0&&(0,c.jsxs)("div",{className:"confidence-scores",children:[(0,c.jsx)("strong",{children:"Confidence Scores:"}),(0,c.jsx)("div",{className:"score-tags",children:Object.entries(e.confidence_scores).map(e=>{let[s,a]=e;return(0,c.jsxs)("span",{className:"score-tag",children:[s,": ",(100*a).toFixed(0),"%"]},s)})})]}),(0,c.jsxs)("div",{className:"review-notes-input",children:[(0,c.jsx)("label",{children:"Review Notes (optional):"}),(0,c.jsx)("textarea",{value:p[e.id]||"",onChange:s=>g(a=>(0,n.A)((0,n.A)({},a),{},{[e.id]:s.target.value})),placeholder:"Add notes about your decision...",rows:"2",className:"notes-textarea"})]}),(0,c.jsxs)("div",{className:"action-buttons",children:[(0,c.jsx)("button",{className:"approve-button",onClick:()=>(async e=>{x(!0);const a=p[e]||"";try{const t=await fetch("".concat(i.JR).concat(i.Sn.ADMIN_MODERATION_APPROVE,"?id=").concat(e),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({review_notes:a})});if(!t.ok)throw new Error("Failed to approve image");const c=await t.json();if(!c.success)throw new Error(c.message||"Failed to approve");s(s=>s.filter(s=>s.id!==e)),o(e=>e-1),g(s=>{const a=(0,n.A)({},s);return delete a[e],a}),w("Image approved successfully","success")}catch(t){console.error("Error approving image:",t),w("Failed to approve image","error")}finally{x(!1)}})(e.id),disabled:j,children:"\u2705 Approve"}),(0,c.jsx)("button",{className:"reject-button",onClick:()=>(async e=>{x(!0);const a=p[e]||"";try{const t=await fetch("".concat(i.JR).concat(i.Sn.ADMIN_MODERATION_REJECT,"?id=").concat(e),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({review_notes:a})});if(!t.ok)throw new Error("Failed to reject image");const c=await t.json();if(!c.success)throw new Error(c.message||"Failed to reject");s(s=>s.filter(s=>s.id!==e)),o(e=>e-1),g(s=>{const a=(0,n.A)({},s);return delete a[e],a}),w("Image rejected successfully","success")}catch(t){console.error("Error rejecting image:",t),w("Failed to reject image","error")}finally{x(!1)}})(e.id),disabled:j,children:"\u274c Reject"})]})]})]},e.id))}),b>1&&(0,c.jsxs)("div",{className:"pagination",children:[(0,c.jsx)("button",{onClick:()=>_(r-1),disabled:1===r,className:"page-button",children:"Previous"}),(0,c.jsxs)("span",{className:"page-info",children:["Page ",r," of ",b]}),(0,c.jsx)("button",{onClick:()=>_(r+1),disabled:r===b,className:"page-button",children:"Next"})]})]}),h&&(0,c.jsx)("div",{className:"image-modal",onClick:()=>u(null),children:(0,c.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,c.jsx)("button",{className:"close-button",onClick:()=>u(null),children:"\xd7"}),(0,c.jsx)("img",{src:h.image_url||"/placeholder-image.jpg",alt:h.original_filename||"Property image",className:"modal-image"}),(0,c.jsxs)("div",{className:"modal-info",children:[(0,c.jsxs)("p",{children:[(0,c.jsx)("strong",{children:"Property ID:"})," ",h.property_id]}),(0,c.jsxs)("p",{children:[(0,c.jsx)("strong",{children:"Reason:"})," ",h.reason_for_review]}),(0,c.jsxs)("p",{children:[(0,c.jsx)("strong",{children:"Filename:"})," ",h.original_filename]})]})]})}),f.show&&(0,c.jsx)("div",{className:"toast toast-".concat(f.type),children:f.message})]})}}}]);
//# sourceMappingURL=110.7131be98.chunk.js.map