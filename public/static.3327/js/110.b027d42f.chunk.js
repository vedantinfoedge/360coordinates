"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[110],{110(e,s,a){a.r(s),a.d(s,{default:()=>o});var n=a(555),i=a(43),t=a(375),c=a(153),l=a(579);const o=()=>{const[e,s]=(0,i.useState)([]),[a,o]=(0,i.useState)(0),[r,d]=(0,i.useState)(1),[m,u]=(0,i.useState)(!1),[h,g]=(0,i.useState)(null),[p,j]=(0,i.useState)(null),[x,v]=(0,i.useState)({}),[N,y]=(0,i.useState)(!1),[f,b]=(0,i.useState)({show:!1,message:"",type:""}),w=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;u(!0),g(null);try{const a=await(0,c.g)("".concat(t.Sn.ADMIN_MODERATION_QUEUE,"?page=").concat(e,"&limit=").concat(20));s(Array.isArray(null===a||void 0===a?void 0:a.items)?a.items:[]),o("number"===typeof(null===a||void 0===a?void 0:a.total)?a.total:0),d(e)}catch(a){g(a.message||"Failed to load moderation queue"),s([]),o(0),_(a.message||"Failed to load moderation queue","error")}finally{u(!1)}};(0,i.useEffect)(()=>{w(r)},[]);const _=function(e){b({show:!0,message:e,type:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success"}),setTimeout(()=>{b({show:!1,message:"",type:""})},3e3)},S=e=>{const s=new Date-new Date(e),a=Math.floor(s/6e4),n=Math.floor(a/60),i=Math.floor(n/24);return i>0?"".concat(i," day").concat(i>1?"s":""):n>0?"".concat(n," hour").concat(n>1?"s":""):"".concat(a," minute").concat(a>1?"s":"")},k=Math.ceil(a/20),A=e=>{e>=1&&e<=k&&w(e)};return(0,l.jsxs)("div",{className:"admin-moderation-queue",children:[(0,l.jsxs)("div",{className:"moderation-header",children:[(0,l.jsx)("h1",{children:"Image Moderation Queue"}),(0,l.jsxs)("div",{className:"queue-count",children:[a," image",1!==a?"s":""," pending review"]})]}),m?(0,l.jsxs)("div",{className:"loading-container",children:[(0,l.jsx)("div",{className:"spinner"}),(0,l.jsx)("p",{children:"Loading moderation queue..."})]}):h?(0,l.jsxs)("div",{className:"empty-state",children:[(0,l.jsx)("div",{className:"empty-icon",style:{fontSize:"48px"},children:"\u26a0\ufe0f"}),(0,l.jsx)("h2",{children:"Unable to load queue"}),(0,l.jsx)("p",{children:h}),(0,l.jsx)("button",{className:"page-button",onClick:()=>w(r),style:{marginTop:"16px"},children:"Retry"})]}):0===e.length?(0,l.jsxs)("div",{className:"empty-state",children:[(0,l.jsx)("div",{className:"empty-icon",children:"\u2705"}),(0,l.jsx)("h2",{children:"No images pending review"}),(0,l.jsx)("p",{children:"All images have been reviewed. Check back later for new submissions."})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"queue-grid",children:e.map(e=>(0,l.jsxs)("div",{className:"queue-item",children:[(0,l.jsx)("div",{className:"item-header",children:(0,l.jsxs)("div",{className:"item-info",children:[(0,l.jsxs)("span",{className:"property-id",children:["Property ID: ",e.property_id]}),(0,l.jsxs)("span",{className:"time-in-queue",children:["In queue: ",S(e.created_at)]})]})}),(0,l.jsx)("div",{className:"item-image",children:(0,l.jsx)("img",{src:e.image_url||"/placeholder-image.jpg",alt:e.original_filename||"Property image",onClick:()=>j(e),className:"thumbnail-image"})}),(0,l.jsxs)("div",{className:"item-details",children:[(0,l.jsxs)("div",{className:"reason-for-review",children:[(0,l.jsx)("strong",{children:"Reason:"})," ",e.reason_for_review||"Needs manual review"]}),e.confidence_scores&&Object.keys(e.confidence_scores).length>0&&(0,l.jsxs)("div",{className:"confidence-scores",children:[(0,l.jsx)("strong",{children:"Confidence Scores:"}),(0,l.jsx)("div",{className:"score-tags",children:Object.entries(e.confidence_scores).map(e=>{let[s,a]=e;return(0,l.jsxs)("span",{className:"score-tag",children:[s,": ",(100*a).toFixed(0),"%"]},s)})})]}),(0,l.jsxs)("div",{className:"review-notes-input",children:[(0,l.jsx)("label",{children:"Review Notes (optional):"}),(0,l.jsx)("textarea",{value:x[e.id]||"",onChange:s=>v(a=>(0,n.A)((0,n.A)({},a),{},{[e.id]:s.target.value})),placeholder:"Add notes about your decision...",rows:"2",className:"notes-textarea"})]}),(0,l.jsxs)("div",{className:"action-buttons",children:[(0,l.jsx)("button",{className:"approve-button",onClick:()=>(async e=>{y(!0);const s=x[e]||"";try{await(0,c.g)("".concat(t.Sn.ADMIN_MODERATION_APPROVE,"?id=").concat(e),{method:"POST",body:JSON.stringify({review_notes:s})}),w(r),v(s=>{const a=(0,n.A)({},s);return delete a[e],a}),_("Image approved successfully","success")}catch(a){_(a.message||"Failed to approve image","error")}finally{y(!1)}})(e.id),disabled:N,children:"\u2705 Approve"}),(0,l.jsx)("button",{className:"reject-button",onClick:()=>(async e=>{y(!0);const s=x[e]||"";try{await(0,c.g)("".concat(t.Sn.ADMIN_MODERATION_REJECT,"?id=").concat(e),{method:"POST",body:JSON.stringify({review_notes:s})}),w(r),v(s=>{const a=(0,n.A)({},s);return delete a[e],a}),_("Image rejected successfully","success")}catch(a){_(a.message||"Failed to reject image","error")}finally{y(!1)}})(e.id),disabled:N,children:"\u274c Reject"})]})]})]},e.id))}),k>1&&(0,l.jsxs)("div",{className:"pagination",children:[(0,l.jsx)("button",{onClick:()=>A(r-1),disabled:1===r,className:"page-button",children:"Previous"}),(0,l.jsxs)("span",{className:"page-info",children:["Page ",r," of ",k]}),(0,l.jsx)("button",{onClick:()=>A(r+1),disabled:r===k,className:"page-button",children:"Next"})]})]}),p&&(0,l.jsx)("div",{className:"image-modal",onClick:()=>j(null),children:(0,l.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,l.jsx)("button",{className:"close-button",onClick:()=>j(null),children:"\xd7"}),(0,l.jsx)("img",{src:p.image_url||"/placeholder-image.jpg",alt:p.original_filename||"Property image",className:"modal-image"}),(0,l.jsxs)("div",{className:"modal-info",children:[(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Property ID:"})," ",p.property_id]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Reason:"})," ",p.reason_for_review]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Filename:"})," ",p.original_filename]})]})]})}),f.show&&(0,l.jsx)("div",{className:"toast toast-".concat(f.type),children:f.message})]})}}}]);
//# sourceMappingURL=110.b027d42f.chunk.js.map