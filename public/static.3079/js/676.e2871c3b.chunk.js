/*! For license information please see 676.e2871c3b.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[676],{292(e,i,s){s.d(i,{A:()=>r});const r=(0,s(784).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},676(e,i,s){s.r(i),s.d(i,{default:()=>o});var r=s(555),a=s(43),n=s(292),t=s(669),l=s(375),d=s(579);const o=()=>{const[e,i]=(0,a.useState)(""),[s,o]=(0,a.useState)(""),[c,p]=(0,a.useState)(""),[x,u]=(0,a.useState)([]),[h,m]=(0,a.useState)({properties:[],agents_builders:[]}),[g,j]=(0,a.useState)(!0),[y,b]=(0,a.useState)(null),[v,f]=(0,a.useState)({page:1,total:0,pages:0}),[N,S]=(0,a.useState)(20),[w,q]=(0,a.useState)(null),[_,k]=(0,a.useState)(!1);(0,a.useEffect)(()=>{f(e=>(0,r.A)((0,r.A)({},e),{},{page:1}))},[s,c,e,N]),(0,a.useEffect)(()=>{A()},[v.page,s,c,e]);const A=async()=>{j(!0),b(null);try{const t=new URLSearchParams({page:v.page.toString(),limit:N.toString()});s&&t.append("property_id",s),c&&t.append("agent_builder_id",c),e&&t.append("search",e);const d=await fetch("".concat(l.JR).concat(l.Sn.ADMIN_INQUIRIES_LIST,"?").concat(t),{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"}),o=await d.text();if(!d.ok){var i,r,a;let e=null;try{e=JSON.parse(o)}catch(n){}throw new Error((null===(i=e)||void 0===i?void 0:i.message)||(null===(r=e)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.message)||(401===d.status?"Authentication required. Please log in again.":403===d.status?"Access denied. Insufficient permissions.":500===d.status?"Server error. Please try again later.":"HTTP error! status: ".concat(d.status)))}let p;try{p=JSON.parse(o)}catch(n){throw console.error("Failed to parse JSON:",n),console.error("Response text:",o),new Error("Invalid JSON response from server: "+o.substring(0,200))}p.success?(u(p.data.inquiries||[]),f(p.data.pagination||{page:1,total:0,pages:0}),p.data.filter_options&&m(p.data.filter_options)):b(p.message||"Failed to load inquiries")}catch(t){console.error("Error fetching inquiries:",t),"TypeError"===t.name&&t.message.includes("fetch")?b("Network error. Please check your connection and ensure the backend server is running."):b(t.message||"Failed to load inquiries")}finally{j(!1)}},I=e=>{if(!e)return"N/A";return new Date(e).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},R=e=>({new:"#3b82f6",contacted:"#8b5cf6",viewed:"#06b6d4",interested:"#10b981",not_interested:"#f59e0b",closed:"#64748b"}[e]||"#64748b");return(0,d.jsxs)("div",{className:"admin-inquiries",children:[(0,d.jsx)("div",{className:"admin-page-header",children:(0,d.jsxs)("div",{children:[(0,d.jsx)("h1",{children:"Inquiry Management"}),(0,d.jsx)("p",{children:g?"Loading...":"".concat(x.length," of ").concat(v.total," inquiries")})]})}),(0,d.jsxs)("div",{className:"admin-filters-bar",children:[(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,d.jsx)("label",{style:{fontSize:"14px",color:"#64748b"},children:"Items per page:"}),(0,d.jsxs)("select",{value:N,onChange:e=>S(Number(e.target.value)),style:{padding:"6px 12px",border:"1px solid #e2e8f0",borderRadius:"6px",fontSize:"14px",cursor:"pointer"},children:[(0,d.jsx)("option",{value:10,children:"10"}),(0,d.jsx)("option",{value:20,children:"20"}),(0,d.jsx)("option",{value:50,children:"50"}),(0,d.jsx)("option",{value:100,children:"100"})]})]}),(0,d.jsxs)("div",{className:"admin-search-box",children:[(0,d.jsxs)("div",{className:"admin-search-input-wrapper",children:[(0,d.jsx)(n.A,{}),(0,d.jsx)("input",{type:"text",placeholder:"Search by name, email, mobile, or property...",value:e,onChange:e=>i(e.target.value),onKeyPress:e=>{"Enter"===e.key&&A()}})]}),(0,d.jsx)("button",{className:"admin-search-btn",onClick:A,children:"Search"})]}),(0,d.jsxs)("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap"},children:[(0,d.jsxs)("select",{value:s,onChange:e=>o(e.target.value),style:{padding:"6px 12px",border:"1px solid #e2e8f0",borderRadius:"6px",fontSize:"14px",cursor:"pointer",minWidth:"200px"},children:[(0,d.jsx)("option",{value:"",children:"All Properties"}),h.properties.map(e=>(0,d.jsx)("option",{value:e.id,children:e.title},e.id))]}),(0,d.jsxs)("select",{value:c,onChange:e=>p(e.target.value),style:{padding:"6px 12px",border:"1px solid #e2e8f0",borderRadius:"6px",fontSize:"14px",cursor:"pointer",minWidth:"200px"},children:[(0,d.jsx)("option",{value:"",children:"All Agents/Builders"}),h.agents_builders.map(e=>(0,d.jsxs)("option",{value:e.id,children:[e.full_name," (","agent"===e.user_type?"Agent":"Builder",")"]},e.id))]})]})]}),y&&(0,d.jsxs)("div",{style:{background:"#fee2e2",color:"#dc2626",padding:"12px 16px",borderRadius:"6px",marginBottom:"20px",border:"1px solid #fecaca"},children:[(0,d.jsx)("strong",{children:"Error:"})," ",y]}),(0,d.jsx)("div",{className:"admin-inquiries-table-container",children:g?(0,d.jsxs)("div",{className:"admin-no-results",children:[(0,d.jsx)("h3",{children:"Loading inquiries..."}),(0,d.jsx)("p",{children:"Please wait while we fetch inquiry data..."})]}):y&&0===x.length?(0,d.jsxs)("div",{className:"admin-no-results",children:[(0,d.jsx)("h3",{children:"Unable to Load Inquiries"}),(0,d.jsx)("p",{children:y}),(0,d.jsx)("button",{onClick:A,style:{marginTop:"15px",padding:"10px 20px",background:"#3b82f6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Retry"})]}):x.length>0?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{style:{marginBottom:"15px",color:"#64748b",fontSize:"14px"},children:["Showing ",x.length," of ",v.total," inquiries (Page ",v.page," of ",v.pages,")"]}),(0,d.jsxs)("table",{className:"admin-inquiries-table",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{children:"INQUIRY ID"}),(0,d.jsx)("th",{children:"USER"}),(0,d.jsx)("th",{children:"PROPERTY"}),(0,d.jsx)("th",{children:"OWNER (Agent/Builder)"}),(0,d.jsx)("th",{children:"DATE & TIME"}),(0,d.jsx)("th",{children:"STATUS"}),(0,d.jsx)("th",{children:"ACTIONS"})]})}),(0,d.jsx)("tbody",{children:x.map(e=>{return(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:["#",e.id]}),(0,d.jsx)("td",{children:(0,d.jsxs)("div",{className:"admin-inquiry-user-cell",children:[(0,d.jsx)("div",{className:"admin-inquiry-user-name",children:e.buyer_name}),(0,d.jsx)("div",{className:"admin-inquiry-user-details",children:e.buyer_mobile}),(0,d.jsx)("div",{className:"admin-inquiry-user-email",children:e.buyer_email})]})}),(0,d.jsx)("td",{children:(0,d.jsxs)("div",{className:"admin-inquiry-property-cell",children:[(0,d.jsx)("div",{className:"admin-inquiry-property-title",children:e.property_title}),(0,d.jsxs)("div",{className:"admin-inquiry-property-details",children:[e.property_location," \u2022 ",(i=e.property_price,i?new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(i):"N/A")]}),(0,d.jsxs)("div",{style:{fontSize:"11px",color:"#64748b"},children:["Property ID: #",e.property_id]})]})}),(0,d.jsx)("td",{children:(0,d.jsxs)("div",{className:"admin-inquiry-owner-cell",children:[(0,d.jsx)("div",{className:"admin-inquiry-owner-name",children:e.seller_name}),(0,d.jsx)("div",{style:{fontSize:"11px",color:"#06b6d4",marginTop:"2px"},children:"agent"===e.seller_type?"Agent":"Builder"}),(0,d.jsx)("div",{className:"admin-inquiry-owner-email",children:e.seller_phone})]})}),(0,d.jsx)("td",{className:"admin-inquiry-date-cell",children:I(e.created_at)}),(0,d.jsx)("td",{children:(0,d.jsx)("span",{className:"admin-status-badge",style:{background:"".concat(R(e.status),"20"),color:R(e.status),textTransform:"capitalize"},children:e.status.replace("_"," ")})}),(0,d.jsx)("td",{className:"admin-actions-column",children:(0,d.jsx)("button",{className:"admin-icon-btn admin-info",title:"View Message",onClick:()=>(e=>{q(e),k(!0)})(e),children:(0,d.jsx)(t.A,{})})})]},e.id);var i})})]}),v.pages>1&&(0,d.jsxs)("div",{className:"admin-pagination",style:{marginTop:"20px",display:"flex",justifyContent:"center",alignItems:"center",gap:"10px"},children:[(0,d.jsx)("button",{onClick:()=>f(e=>(0,r.A)((0,r.A)({},e),{},{page:Math.max(1,e.page-1)})),disabled:1===v.page,style:{padding:"8px 16px",border:"1px solid #e2e8f0",borderRadius:"6px",background:1===v.page?"#f1f5f9":"white",cursor:1===v.page?"not-allowed":"pointer"},children:"Previous"}),(0,d.jsxs)("span",{style:{padding:"0 10px"},children:["Page ",v.page," of ",v.pages," (",v.total," total inquiries)"]}),(0,d.jsx)("button",{onClick:()=>f(e=>(0,r.A)((0,r.A)({},e),{},{page:Math.min(e.pages,e.page+1)})),disabled:v.page===v.pages,style:{padding:"8px 16px",border:"1px solid #e2e8f0",borderRadius:"6px",background:v.page===v.pages?"#f1f5f9":"white",cursor:v.page===v.pages?"not-allowed":"pointer"},children:"Next"})]})]}):(0,d.jsxs)("div",{className:"admin-no-results",children:[(0,d.jsx)("h3",{children:"No inquiries found"}),(0,d.jsx)("p",{children:"Try adjusting your search or filters"})]})}),_&&w&&(0,d.jsx)("div",{className:"admin-modal-overlay",onClick:()=>k(!1),children:(0,d.jsxs)("div",{className:"admin-modal-content",onClick:e=>e.stopPropagation(),children:[(0,d.jsxs)("div",{className:"admin-modal-header",children:[(0,d.jsx)("h2",{children:"Inquiry Message"}),(0,d.jsx)("button",{className:"admin-modal-close",onClick:()=>k(!1),children:"\xd7"})]}),(0,d.jsxs)("div",{className:"admin-modal-body",children:[(0,d.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,d.jsx)("strong",{children:"From:"})," ",w.buyer_name," (",w.buyer_email,")"]}),(0,d.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,d.jsx)("strong",{children:"Property:"})," ",w.property_title]}),(0,d.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,d.jsx)("strong",{children:"Message:"}),(0,d.jsx)("div",{style:{marginTop:"10px",padding:"15px",background:"#f8fafc",borderRadius:"6px",whiteSpace:"pre-wrap",lineHeight:"1.6"},children:w.message||"No message provided"})]}),(0,d.jsxs)("div",{style:{fontSize:"12px",color:"#64748b"},children:[(0,d.jsx)("strong",{children:"Inquiry Date:"})," ",I(w.created_at)]})]})]})})]})}}}]);
//# sourceMappingURL=676.e2871c3b.chunk.js.map