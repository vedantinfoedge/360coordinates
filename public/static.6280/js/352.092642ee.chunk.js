"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[352],{352(e,a,t){t.r(a),t.d(a,{default:()=>x});var s=t(555),n=t(43),i=t(685),r=t(639),l=t(118),d=t(254),o=t(995),c=t(819),p=t(375),h=t(153),u=t(579);const x=()=>{const e=(0,i.Zp)(),[a,t]=(0,n.useState)(null),[x,m]=(0,n.useState)(!0),[v,b]=(0,n.useState)(null),[g,f]=(0,n.useState)([]),[y,j]=(0,n.useState)([]),[N,S]=(0,n.useState)("7d"),[k,A]=(0,n.useState)(null),_=(0,n.useRef)(!1);(0,n.useEffect)(()=>{w(!0);const e=setInterval(()=>{_.current||"undefined"!==typeof document&&"visible"!==document.visibilityState||w(!1)},18e4);return()=>clearInterval(e)},[N]);const w=async function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!_.current){_.current=!0,e&&(m(!0),b(null));try{var a,s,n,i,c,u,x,v,g,y,S,k,w;const e=new URLSearchParams;"all"!==N&&e.append("date_range",N),e.append("_t",Date.now().toString());const m="".concat(p.Sn.ADMIN_DASHBOARD_STATS,"?").concat(e.toString()),b=await(0,h.g)(m,{cache:"no-store"}),_=Number(null!==(a=null!==(s=b.total_properties)&&void 0!==s?s:b.totalProperties)&&void 0!==a?a:0)||0,T=Number(null!==(n=null!==(i=b.total_users)&&void 0!==i?i:b.totalUsers)&&void 0!==n?n:0)||0,R=Number(null!==(c=b.pending_properties)&&void 0!==c?c:0)||0,D=Number(null!==(u=null===(x=b.users_by_type)||void 0===x?void 0:x.buyer)&&void 0!==u?u:0)||0,L=Number(null!==(v=null===(g=b.users_by_type)||void 0===g?void 0:g.seller)&&void 0!==v?v:0)||0,P=[{title:"Total Properties",value:String(_),change:"".concat(R," pending"),trend:"up",icon:r.A,color:"#3b82f6",path:"/admin/properties"},{title:"Total Users",value:String(T),change:"".concat(D," buyers, ").concat(L," sellers"),trend:"up",icon:l.A,color:"#8b5cf6",path:"/admin/users"},{title:"Active Agents",value:String(Number(null!==(y=b.total_agents)&&void 0!==y?y:0)||0),change:"".concat(Number(null!==(S=b.total_agents)&&void 0!==S?S:0)||0," total agents"),trend:"up",icon:d.A,color:"#06b6d4",path:"/admin/agents"},{title:"Active Subscriptions",value:String(Number(null!==(k=b.active_subscriptions)&&void 0!==k?k:0)||0),change:"".concat(Number(null!==(w=b.expired_subscriptions)&&void 0!==w?w:0)||0," expired"),trend:"up",icon:o.A,color:"#8b5cf6",path:"/admin/subscriptions"}];t(P),f(b.property_types_distribution||[]),j(b.recent_properties||[]),A(new Date)}catch(T){b(T.message||"Failed to load dashboard data.")}finally{e&&m(!1),_.current=!1}}},T=e=>({Apartment:"#3b82f6",House:"#10b981",Villa:"#8b5cf6",Commercial:"#f59e0b",Land:"#06b6d4",Plot:"#ef4444",Office:"#6366f1"}[e]||(e=>{if(!e)return"#64748b";let a=0;for(let i=0;i<e.length;i++)a=e.charCodeAt(i)+((a<<5)-a);const t=Math.abs(a)%360,s=60+Math.abs(a)%20,n=45+Math.abs(a)%15;return"hsl(".concat(t,", ").concat(s,"%, ").concat(n,"%)")})(e)),R=(()=>{if(!g||0===g.length)return null;const e=g.reduce((e,a)=>e+a.count,0);if(0===e)return null;const a=2*Math.PI*80;let t=0;return g.map((n,i)=>{const r=n.count/e*100,l=r/100*a,d=-t;return t+=l,(0,s.A)((0,s.A)({},n),{},{percentage:r.toFixed(1),dashArray:"".concat(l," ").concat(a),dashOffset:d,color:T(n.name)})})})();return x?(0,u.jsxs)("div",{className:"admin-dashboard",children:[(0,u.jsx)("div",{className:"admin-dashboard-header",children:(0,u.jsxs)("div",{children:[(0,u.jsx)("h1",{children:"Dashboard"}),(0,u.jsx)("p",{children:"Loading dashboard data..."})]})}),(0,u.jsx)("div",{className:"admin-stats-grid",children:[1,2,3,4,5,6].map(e=>(0,u.jsxs)("div",{className:"admin-stat-card",style:{opacity:.6},children:[(0,u.jsxs)("div",{className:"admin-stat-header",children:[(0,u.jsx)("div",{className:"admin-stat-title",style:{background:"#e2e8f0",height:"16px",width:"100px",borderRadius:"4px",animation:"pulse 1.5s ease-in-out infinite"}}),(0,u.jsx)("div",{className:"admin-stat-icon",style:{background:"#e2e8f0",animation:"pulse 1.5s ease-in-out infinite"}})]}),(0,u.jsx)("div",{className:"admin-stat-value",style:{background:"#e2e8f0",height:"32px",width:"80px",borderRadius:"4px",animation:"pulse 1.5s ease-in-out infinite"}}),(0,u.jsx)("div",{style:{background:"#e2e8f0",height:"14px",width:"120px",borderRadius:"4px",marginTop:"8px",animation:"pulse 1.5s ease-in-out infinite"}})]},e))}),(0,u.jsx)("style",{children:"\n          @keyframes pulse {\n            0%, 100% { opacity: 1; }\n            50% { opacity: 0.5; }\n          }\n        "})]}):v?(0,u.jsx)("div",{className:"admin-dashboard",children:(0,u.jsxs)("div",{className:"admin-dashboard-header",children:[(0,u.jsx)("h1",{children:"Dashboard"}),(0,u.jsxs)("div",{style:{color:"#ef4444",marginTop:"20px"},children:[(0,u.jsx)(c.A,{size:20,style:{marginRight:"8px",verticalAlign:"middle"}}),v]})]})}):(0,u.jsxs)("div",{className:"admin-dashboard",children:[(0,u.jsxs)("div",{className:"admin-dashboard-header",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("h1",{children:"Dashboard"}),(0,u.jsxs)("p",{children:["Welcome back! Here's an overview of your platform.",k&&(0,u.jsxs)("span",{style:{fontSize:"12px",color:"#64748b",marginLeft:"8px"},children:["Updated ",k.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})]}),(0,u.jsx)("span",{style:{fontSize:"12px",color:"#94a3b8",marginLeft:"4px"},children:"(refreshes every 3 min)"})]})]}),(0,u.jsxs)("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[(0,u.jsxs)("select",{value:N,onChange:e=>S(e.target.value),style:{padding:"8px 12px",border:"1px solid #e2e8f0",borderRadius:"6px",fontSize:"14px",cursor:"pointer",background:"white"},children:[(0,u.jsx)("option",{value:"7d",children:"Last 7 days"}),(0,u.jsx)("option",{value:"30d",children:"Last 30 days"}),(0,u.jsx)("option",{value:"90d",children:"Last 90 days"}),(0,u.jsx)("option",{value:"all",children:"All time"})]}),(0,u.jsx)("button",{onClick:w,style:{padding:"8px 16px",background:"#3b82f6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px"},disabled:x,children:x?"Refreshing...":"Refresh"})]})]}),a&&(0,u.jsx)("div",{className:"admin-stats-grid",children:a.map((a,t)=>{const s=a.icon,n=null!==a.path;return(0,u.jsx)("div",{className:"admin-stat-card ".concat(n?"admin-stat-card-clickable":""),onClick:()=>{n&&a.path&&e(a.path)},style:{cursor:n?"pointer":"default",transition:"all 0.2s ease"},onMouseEnter:e=>{n&&(e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.1)")},onMouseLeave:e=>{n&&(e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="")},children:(0,u.jsxs)("div",{className:"admin-stat-content",children:[(0,u.jsxs)("div",{className:"admin-stat-header",children:[(0,u.jsx)("span",{className:"admin-stat-title",children:a.title}),(0,u.jsx)("div",{className:"admin-stat-icon",style:{background:"".concat(a.color,"20")},children:(0,u.jsx)(s,{style:{color:a.color}})})]}),(0,u.jsx)("div",{className:"admin-stat-value",children:a.value}),a.change&&(0,u.jsx)("div",{className:"admin-stat-change ".concat(a.trend),children:(0,u.jsx)("span",{children:a.change})}),n&&(0,u.jsx)("div",{style:{marginTop:"8px",fontSize:"12px",color:a.color,fontWeight:"500",opacity:.8},children:"Click to view \u2192"})]})},t)})}),(0,u.jsx)("div",{style:{marginTop:"20px"},children:(0,u.jsxs)("div",{className:"admin-dashboard-card",children:[(0,u.jsx)("h2",{children:"Recent Properties"}),y.length>0?(0,u.jsx)("div",{style:{marginTop:"15px"},children:y.map((e,a)=>{var t;return(0,u.jsxs)("div",{style:{padding:"12px",borderBottom:a<y.length-1?"1px solid #e2e8f0":"none",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,u.jsxs)("div",{style:{flex:1},children:[(0,u.jsx)("div",{style:{fontWeight:"600",color:"#1e293b",marginBottom:"4px"},children:e.title||"Untitled Property"}),(0,u.jsxs)("div",{style:{fontSize:"12px",color:"#64748b"},children:[e.seller_name||"Unknown"," \u2022 \u20b9",(null===(t=e.price)||void 0===t?void 0:t.toLocaleString("en-IN"))||"0"]})]}),(0,u.jsx)("div",{style:{padding:"4px 8px",borderRadius:"4px",background:e.is_active?"#10b98120":"#f59e0b20",color:e.is_active?"#10b981":"#f59e0b",fontSize:"11px",fontWeight:"500"},children:e.is_active?"Active":"Pending"})]},e.id||a)})}):(0,u.jsx)("p",{style:{textAlign:"center",color:"#64748b",padding:"20px"},children:"No recent properties"})]})}),R&&R.length>0?(0,u.jsxs)("div",{className:"admin-dashboard-card",style:{marginTop:"20px"},children:[(0,u.jsx)("h2",{children:"Property Types Distribution"}),(0,u.jsxs)("div",{className:"admin-pie-chart-container",children:[(0,u.jsx)("svg",{viewBox:"0 0 200 200",className:"admin-pie-chart",children:R.map((e,a)=>(0,u.jsx)("circle",{cx:"100",cy:"100",r:"80",fill:"none",stroke:e.color,strokeWidth:"40",strokeDasharray:e.dashArray,strokeDashoffset:e.dashOffset,transform:"rotate(-90 100 100)"},a))}),(0,u.jsx)("div",{className:"admin-pie-labels",children:R.map((e,a)=>(0,u.jsxs)("div",{className:"admin-pie-label",children:[(0,u.jsx)("span",{className:"admin-pie-color",style:{background:e.color}}),(0,u.jsxs)("span",{className:"admin-pie-text",children:[e.name," ",e.percentage,"% (",e.count,")"]})]},a))})]})]}):(0,u.jsxs)("div",{className:"admin-dashboard-card",style:{marginTop:"20px"},children:[(0,u.jsx)("h2",{children:"Property Types Distribution"}),(0,u.jsx)("p",{style:{textAlign:"center",color:"#64748b",padding:"40px"},children:"No property data available"})]})]})}}}]);
//# sourceMappingURL=352.092642ee.chunk.js.map