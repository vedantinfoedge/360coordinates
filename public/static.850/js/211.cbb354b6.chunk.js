/*! For license information please see 211.cbb354b6.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[211],{211(e,s,a){a.r(s),a.d(s,{default:()=>c});var i=a(555),n=a(43),r=a(292),t=a(580),l=a(995),d=a(375),o=a(579);const c=()=>{const[e,s]=(0,n.useState)(""),[a,c]=(0,n.useState)("All Plans"),[p,u]=(0,n.useState)("All Status"),[h,x]=(0,n.useState)(!1),[m,g]=(0,n.useState)([]),[j,b]=(0,n.useState)(!0),[v,f]=(0,n.useState)(null),[y,S]=(0,n.useState)({page:1,total:0,pages:0}),[N,A]=(0,n.useState)(20);(0,n.useEffect)(()=>{S(e=>(0,i.A)((0,i.A)({},e),{},{page:1}))},[a,p,e,N]),(0,n.useEffect)(()=>{w()},[y.page,a,p,e]);const w=async()=>{b(!0),f(null);try{const t=new URLSearchParams({page:y.page.toString(),limit:N.toString()});"All Plans"!==a&&t.append("plan_type",a.toLowerCase()),"All Status"!==p&&t.append("status",p.toLowerCase()),e&&t.append("search",e);const l=await fetch("".concat(d.JR).concat(d.Sn.ADMIN_SUBSCRIPTIONS_LIST,"?").concat(t),{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"}),o=await l.text();if(!l.ok){var s,i,n;let e=null;try{e=JSON.parse(o)}catch(r){}throw new Error((null===(s=e)||void 0===s?void 0:s.message)||(null===(i=e)||void 0===i||null===(n=i.data)||void 0===n?void 0:n.message)||(401===l.status?"Authentication required. Please log in again.":403===l.status?"Access denied. Insufficient permissions.":500===l.status?"Server error. Please try again later.":"HTTP error! status: ".concat(l.status)))}let c;try{c=JSON.parse(o)}catch(r){throw console.error("Failed to parse JSON:",r),console.error("Response text:",o),new Error("Invalid JSON response from server: "+o.substring(0,200))}c.success?(g(c.data.subscriptions||[]),S(c.data.pagination||{page:1,total:0,pages:0})):f(c.message||"Failed to load subscriptions")}catch(t){console.error("Error fetching subscriptions:",t),"TypeError"===t.name&&t.message.includes("fetch")?f("Network error. Please check your connection and ensure the backend server is running."):f(t.message||"Failed to load subscriptions")}finally{b(!1)}},k=e=>{if(!e)return"N/A";return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})},P=e=>({free:"#64748b",basic:"#3b82f6",pro:"#8b5cf6",premium:"#f59e0b"}[e]||"#64748b"),C=e=>e?"#10b981":"#ef4444";return(0,o.jsxs)("div",{className:"admin-subscriptions",children:[(0,o.jsx)("div",{className:"admin-page-header",children:(0,o.jsxs)("div",{children:[(0,o.jsx)("h1",{children:"Subscription Management"}),(0,o.jsx)("p",{children:j?"Loading...":"".concat(m.length," of ").concat(y.total," subscriptions")})]})}),(0,o.jsxs)("div",{className:"admin-filters-bar",children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,o.jsx)("label",{style:{fontSize:"14px",color:"#64748b"},children:"Items per page:"}),(0,o.jsxs)("select",{value:N,onChange:e=>A(Number(e.target.value)),style:{padding:"6px 12px",border:"1px solid #e2e8f0",borderRadius:"6px",fontSize:"14px",cursor:"pointer"},children:[(0,o.jsx)("option",{value:10,children:"10"}),(0,o.jsx)("option",{value:20,children:"20"}),(0,o.jsx)("option",{value:50,children:"50"}),(0,o.jsx)("option",{value:100,children:"100"})]})]}),(0,o.jsxs)("div",{className:"admin-search-box",children:[(0,o.jsxs)("div",{className:"admin-search-input-wrapper",children:[(0,o.jsx)(r.A,{}),(0,o.jsx)("input",{type:"text",placeholder:"Search by name, email, or phone...",value:e,onChange:e=>s(e.target.value),onKeyPress:e=>{"Enter"===e.key&&w()}})]}),(0,o.jsx)("button",{className:"admin-search-btn",onClick:w,children:"Search"})]}),(0,o.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,o.jsxs)("select",{value:a,onChange:e=>c(e.target.value),style:{padding:"6px 12px",border:"1px solid #e2e8f0",borderRadius:"6px",fontSize:"14px",cursor:"pointer",minWidth:"150px"},children:[(0,o.jsx)("option",{value:"All Plans",children:"All Plans"}),(0,o.jsx)("option",{value:"Free",children:"Free"}),(0,o.jsx)("option",{value:"Basic",children:"Basic"}),(0,o.jsx)("option",{value:"Pro",children:"Pro"}),(0,o.jsx)("option",{value:"Premium",children:"Premium"})]}),(0,o.jsxs)("div",{style:{position:"relative"},children:[(0,o.jsxs)("button",{className:"admin-filter-btn",onClick:()=>x(!h),children:[(0,o.jsx)(t.A,{}),p]}),h&&(0,o.jsx)("div",{className:"admin-filter-dropdown",children:["All Status","Active","Expired"].map(e=>(0,o.jsx)("div",{className:"admin-filter-option ".concat(p===e?"admin-active":""),onClick:()=>{u(e),x(!1)},children:e},e))})]})]})]}),v&&(0,o.jsxs)("div",{style:{background:"#fee2e2",color:"#dc2626",padding:"12px 16px",borderRadius:"6px",marginBottom:"20px",border:"1px solid #fecaca"},children:[(0,o.jsx)("strong",{children:"Error:"})," ",v]}),(0,o.jsx)("div",{className:"admin-subscriptions-table-container",children:j?(0,o.jsxs)("div",{className:"admin-no-results",children:[(0,o.jsx)("h3",{children:"Loading subscriptions..."}),(0,o.jsx)("p",{children:"Please wait while we fetch subscription data..."})]}):v&&0===m.length?(0,o.jsxs)("div",{className:"admin-no-results",children:[(0,o.jsx)("h3",{children:"Unable to Load Subscriptions"}),(0,o.jsx)("p",{children:v}),(0,o.jsx)("button",{onClick:w,style:{marginTop:"15px",padding:"10px 20px",background:"#3b82f6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Retry"})]}):m.length>0?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{style:{marginBottom:"15px",color:"#64748b",fontSize:"14px"},children:["Showing ",m.length," of ",y.total," subscriptions (Page ",y.page," of ",y.pages,")"]}),(0,o.jsxs)("table",{className:"admin-subscriptions-table",children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{children:"USER"}),(0,o.jsx)("th",{children:"SUBSCRIPTION PLAN"}),(0,o.jsx)("th",{children:"START DATE"}),(0,o.jsx)("th",{children:"EXPIRY DATE"}),(0,o.jsx)("th",{children:"STATUS"})]})}),(0,o.jsx)("tbody",{children:m.map(e=>{return(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:(0,o.jsxs)("div",{className:"admin-subscription-user-cell",children:[(0,o.jsx)("div",{className:"admin-subscription-user-avatar",children:(s=e.user_name,s?s.split(" ").map(e=>e[0]).join("").toUpperCase().substring(0,2):"U")}),(0,o.jsxs)("div",{className:"admin-subscription-user-info",children:[(0,o.jsx)("div",{className:"admin-subscription-user-name",children:e.user_name}),(0,o.jsx)("div",{className:"admin-subscription-user-email",children:e.user_email}),(0,o.jsx)("div",{className:"admin-subscription-user-phone",children:e.user_phone})]})]})}),(0,o.jsx)("td",{children:(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,o.jsx)(l.A,{size:18,style:{color:P(e.plan_type)}}),(0,o.jsx)("span",{style:{padding:"4px 12px",borderRadius:"4px",background:"".concat(P(e.plan_type),"20"),color:P(e.plan_type),fontSize:"13px",fontWeight:"600",textTransform:"capitalize"},children:e.plan_type})]})}),(0,o.jsx)("td",{className:"admin-subscription-date-cell",children:k(e.start_date)}),(0,o.jsx)("td",{className:"admin-subscription-date-cell",children:e.end_date?k(e.end_date):"No expiry"}),(0,o.jsx)("td",{children:(0,o.jsx)("span",{className:"admin-status-badge",style:{background:"".concat(C(e.is_active),"20"),color:C(e.is_active)},children:e.is_active?"Active":"Expired"})})]},e.id);var s})})]}),y.pages>1&&(0,o.jsxs)("div",{className:"admin-pagination",style:{marginTop:"20px",display:"flex",justifyContent:"center",alignItems:"center",gap:"10px"},children:[(0,o.jsx)("button",{onClick:()=>S(e=>(0,i.A)((0,i.A)({},e),{},{page:Math.max(1,e.page-1)})),disabled:1===y.page,style:{padding:"8px 16px",border:"1px solid #e2e8f0",borderRadius:"6px",background:1===y.page?"#f1f5f9":"white",cursor:1===y.page?"not-allowed":"pointer"},children:"Previous"}),(0,o.jsxs)("span",{style:{padding:"0 10px"},children:["Page ",y.page," of ",y.pages," (",y.total," total subscriptions)"]}),(0,o.jsx)("button",{onClick:()=>S(e=>(0,i.A)((0,i.A)({},e),{},{page:Math.min(e.pages,e.page+1)})),disabled:y.page===y.pages,style:{padding:"8px 16px",border:"1px solid #e2e8f0",borderRadius:"6px",background:y.page===y.pages?"#f1f5f9":"white",cursor:y.page===y.pages?"not-allowed":"pointer"},children:"Next"})]})]}):(0,o.jsxs)("div",{className:"admin-no-results",children:[(0,o.jsx)("h3",{children:"No subscriptions found"}),(0,o.jsx)("p",{children:"Try adjusting your search or filters"})]})})]})}},292(e,s,a){a.d(s,{A:()=>i});const i=(0,a(784).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])}}]);
//# sourceMappingURL=211.cbb354b6.chunk.js.map