/*! For license information please see 796.846c53e3.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[796],{292(e,t,s){s.d(t,{A:()=>a});const a=(0,s(784).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},796(e,t,s){s.r(t),s.d(t,{default:()=>y});var a=s(555),r=s(43),n=s(292),i=s(580),l=s(87),o=s(784);const c=(0,o.A)("heart",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]]),d=(0,o.A)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),p=(0,o.A)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);var h=s(614),x=s(855),u=s(375),j=s(295),m=s(579);const y=()=>{const[e,t]=(0,r.useState)(""),[s,o]=(0,r.useState)("All Status"),[y,g]=(0,r.useState)(""),[v,f]=(0,r.useState)(""),[b,S]=(0,r.useState)(""),[N,A]=(0,r.useState)(""),[E,P]=(0,r.useState)(!1),[R,w]=(0,r.useState)([]),[I,T]=(0,r.useState)({cities:[],property_types:[]}),[k,C]=(0,r.useState)(!0),[_,O]=(0,r.useState)(null),[M,F]=(0,r.useState)({page:1,total:0,pages:0}),[L,z]=(0,r.useState)(20),[J,D]=(0,r.useState)(!1),[W,V]=(0,r.useState)(null);(0,r.useEffect)(()=>{F(e=>(0,a.A)((0,a.A)({},e),{},{page:1}))},[s,e,y,v,b,N,L]),(0,r.useEffect)(()=>{U()},[M.page,s,e,y,v,b,N]);const U=async()=>{C(!0),O(null);try{const i=new URLSearchParams({page:M.page.toString(),limit:L.toString()});"All Status"!==s&&("Approved"===s?i.append("status","approved"):"Pending"===s?i.append("status","pending"):"Sold"===s&&i.append("status","sold")),y&&i.append("city",y),v&&i.append("property_type",v),b&&i.append("min_price",b),N&&i.append("max_price",N),e&&i.append("search",e);const l=await fetch("".concat(u.JR).concat(u.Sn.ADMIN_PROPERTIES_LIST,"?").concat(i),{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"}),o=await l.text();if(!l.ok){var t,a,r;let e=null;try{e=JSON.parse(o)}catch(n){}throw new Error((null===(t=e)||void 0===t?void 0:t.message)||(null===(a=e)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.message)||(401===l.status?"Authentication required. Please log in again.":403===l.status?"Access denied. Insufficient permissions.":500===l.status?"Server error. Please try again later.":"HTTP error! status: ".concat(l.status)))}let c;try{c=JSON.parse(o)}catch(n){throw console.error("Failed to parse JSON:",n),console.error("Response text:",o),new Error("Invalid JSON response from server: "+o.substring(0,200))}c.success?(w(c.data.properties||[]),F(c.data.pagination||{page:1,total:0,pages:0}),c.data.filter_options&&T(c.data.filter_options)):O(c.message||"Failed to load properties")}catch(i){console.error("Error fetching properties:",i),"TypeError"===i.name&&i.message.includes("fetch")?O("Network error. Please check your connection and ensure the backend server is running."):O(i.message||"Failed to load properties")}finally{C(!1)}},G=e=>e?"#10b981":"#f59e0b",H=e=>e?"Approved":"Pending";return(0,m.jsxs)("div",{className:"admin-properties",children:[(0,m.jsx)("div",{className:"admin-page-header",children:(0,m.jsxs)("div",{children:[(0,m.jsx)("h1",{children:"Manage Properties"}),(0,m.jsx)("p",{children:k?"Loading...":"".concat(R.length," of ").concat(M.total," properties")})]})}),(0,m.jsxs)("div",{className:"admin-filters-bar",children:[(0,m.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,m.jsx)("label",{style:{fontSize:"14px",color:"#64748b"},children:"Items per page:"}),(0,m.jsxs)("select",{value:L,onChange:e=>z(Number(e.target.value)),style:{padding:"6px 12px",border:"1px solid #e2e8f0",borderRadius:"6px",fontSize:"14px",cursor:"pointer"},children:[(0,m.jsx)("option",{value:10,children:"10"}),(0,m.jsx)("option",{value:20,children:"20"}),(0,m.jsx)("option",{value:50,children:"50"}),(0,m.jsx)("option",{value:100,children:"100"})]})]}),(0,m.jsxs)("div",{className:"admin-search-box",children:[(0,m.jsxs)("div",{className:"admin-search-input-wrapper",children:[(0,m.jsx)(n.A,{}),(0,m.jsx)("input",{type:"text",placeholder:"Search by name, location, or type...",value:e,onChange:e=>t(e.target.value),onKeyPress:e=>{"Enter"===e.key&&U()}})]}),(0,m.jsx)("button",{className:"admin-search-btn",onClick:U,children:"Search"})]}),(0,m.jsxs)("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap",alignItems:"center"},children:[(0,m.jsxs)("div",{style:{position:"relative"},children:[(0,m.jsxs)("button",{className:"admin-filter-btn",onClick:()=>P(!E),children:[(0,m.jsx)(i.A,{}),s]}),E&&(0,m.jsx)("div",{className:"admin-filter-dropdown",children:["All Status","Approved","Pending","Sold"].map(e=>(0,m.jsx)("div",{className:"admin-filter-option ".concat(s===e?"admin-active":""),onClick:()=>{o(e),P(!1)},children:e},e))})]}),(0,m.jsxs)("select",{value:y,onChange:e=>g(e.target.value),style:{padding:"6px 12px",border:"1px solid #e2e8f0",borderRadius:"6px",fontSize:"14px",cursor:"pointer",minWidth:"150px"},children:[(0,m.jsx)("option",{value:"",children:"All Cities"}),I.cities.map(e=>(0,m.jsx)("option",{value:e,children:e},e))]}),(0,m.jsxs)("select",{value:v,onChange:e=>f(e.target.value),style:{padding:"6px 12px",border:"1px solid #e2e8f0",borderRadius:"6px",fontSize:"14px",cursor:"pointer",minWidth:"150px"},children:[(0,m.jsx)("option",{value:"",children:"All Types"}),I.property_types.map(e=>(0,m.jsx)("option",{value:e,children:e},e))]}),(0,m.jsxs)("div",{style:{display:"flex",gap:"5px",alignItems:"center"},children:[(0,m.jsx)("input",{type:"number",placeholder:"Min Price",value:b,onChange:e=>S(e.target.value),style:{padding:"6px 12px",border:"1px solid #e2e8f0",borderRadius:"6px",fontSize:"14px",width:"120px"}}),(0,m.jsx)("span",{style:{color:"#64748b"},children:"to"}),(0,m.jsx)("input",{type:"number",placeholder:"Max Price",value:N,onChange:e=>A(e.target.value),style:{padding:"6px 12px",border:"1px solid #e2e8f0",borderRadius:"6px",fontSize:"14px",width:"120px"}})]})]})]}),(0,m.jsx)("div",{className:"admin-properties-table-container",children:k?(0,m.jsx)("div",{className:"admin-no-results",children:(0,m.jsx)("h3",{children:"Loading properties..."})}):_?(0,m.jsxs)("div",{className:"admin-no-results",children:[(0,m.jsx)("h3",{children:"Error"}),(0,m.jsx)("p",{children:_})]}):R.length>0?(0,m.jsxs)("table",{className:"admin-properties-table",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{children:"ID"}),(0,m.jsx)("th",{children:"PROPERTY"}),(0,m.jsx)("th",{children:"TYPE"}),(0,m.jsx)("th",{children:"LISTING"}),(0,m.jsx)("th",{children:"PRICE"}),(0,m.jsx)("th",{children:"VIEWS"}),(0,m.jsx)("th",{children:"INTEREST"}),(0,m.jsx)("th",{children:"FAVORITES"}),(0,m.jsx)("th",{children:"STATUS"}),(0,m.jsx)("th",{children:"ACTIONS"})]})}),(0,m.jsx)("tbody",{children:R.map(e=>{var t;const s=e.is_active||!1;return(0,m.jsxs)("tr",{children:[(0,m.jsxs)("td",{children:["#",e.id]}),(0,m.jsx)("td",{children:(0,m.jsxs)("div",{className:"admin-property-cell",children:[(0,m.jsx)("div",{className:"admin-property-icon",children:e.cover_image?(0,m.jsx)("img",{src:e.cover_image,alt:""}):(0,m.jsx)("div",{style:{width:"40px",height:"40px",background:"#e5e7eb",borderRadius:"4px"}})}),(0,m.jsxs)("div",{children:[(0,m.jsx)("div",{className:"admin-property-name",children:e.title||"Untitled Property"}),(0,m.jsx)("div",{className:"admin-property-location",children:e.location||"N/A"})]})]})}),(0,m.jsx)("td",{children:e.property_type||"N/A"}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{className:"admin-listing-badge ".concat((null===(t=e.status)||void 0===t?void 0:t.toLowerCase())||"sale"),children:"rent"===e.status?"Rent":"Sale"})}),(0,m.jsx)("td",{className:"admin-price-cell",children:(a=e.price,a?new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(a):"N/A")}),(0,m.jsx)("td",{children:(0,m.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,m.jsx)(l.A,{size:16,style:{color:"#64748b"}}),(0,m.jsx)("span",{style:{fontWeight:"500",color:"#1e293b"},children:e.views_count||0})]})}),(0,m.jsx)("td",{children:(0,m.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,m.jsx)(c,{size:16,style:{color:"#f59e0b",fill:"#f59e0b"}}),(0,m.jsx)("span",{style:{fontWeight:"500",color:"#1e293b"},children:e.interest_count||0})]})}),(0,m.jsx)("td",{children:(0,m.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,m.jsx)(d,{size:16,style:{color:"#eab308",fill:"#eab308"}}),(0,m.jsx)("span",{style:{fontWeight:"500",color:"#1e293b"},children:e.favorites_count||0})]})}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{className:"admin-status-badge",style:{background:"".concat(G(s),"20"),color:G(s)},children:H(s)})}),(0,m.jsx)("td",{className:"admin-actions-column",children:(0,m.jsxs)("div",{className:"admin-action-buttons",children:[(0,m.jsx)("button",{className:"admin-properties-icon-btn",title:"View",children:(0,m.jsx)(l.A,{})}),!s&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("button",{className:"admin-properties-icon-btn admin-approve-btn",title:"Approve",onClick:()=>(async e=>{try{const t=await fetch("".concat(u.JR).concat(u.Sn.ADMIN_PROPERTIES_APPROVE,"?id=").concat(e),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"}),s=await t.json();s.success?U():alert(s.message||"Failed to approve property")}catch(t){console.error("Error approving property:",t),alert("Failed to approve property")}})(e.id),children:(0,m.jsx)(p,{})}),(0,m.jsx)("button",{className:"admin-properties-icon-btn admin-reject-btn",title:"Reject",onClick:()=>(async e=>{const t=window.prompt("Enter rejection reason (optional):");if(null!==t)try{const s=await fetch("".concat(u.JR).concat(u.Sn.ADMIN_PROPERTIES_REJECT,"?id=").concat(e),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({reason:t||"Property rejected by admin"})}),a=await s.json();a.success?U():alert(a.message||"Failed to reject property")}catch(s){console.error("Error rejecting property:",s),alert("Failed to reject property")}})(e.id),children:(0,m.jsx)(h.A,{})})]}),(0,m.jsx)("button",{className:"admin-properties-icon-btn admin-danger",title:"Delete",onClick:()=>{return t=e.id,V(t),void D(!0);var t},children:(0,m.jsx)(x.A,{})})]})})]},e.id);var a})})]}):(0,m.jsxs)("div",{className:"admin-no-results",children:[(0,m.jsx)("h3",{children:"No properties found"}),(0,m.jsx)("p",{children:"Try adjusting your search or filters"})]})}),(0,m.jsx)(j.A,{isOpen:J,onClose:()=>{D(!1),V(null)},onConfirm:async()=>{if(W)try{const e=await fetch("".concat(u.JR).concat(u.Sn.ADMIN_PROPERTIES_DELETE,"?id=").concat(W),{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include"}),t=await e.json();t.success?(U(),V(null)):alert(t.message||"Failed to delete property")}catch(e){console.error("Error deleting property:",e),alert("Failed to delete property")}}})]})}},855(e,t,s){s.d(t,{A:()=>a});const a=(0,s(784).A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])}}]);
//# sourceMappingURL=796.846c53e3.chunk.js.map