/*! For license information please see 566.b5eebba2.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[566],{292(e,a,n){n.d(a,{A:()=>s});const s=(0,n(784).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},566(e,a,n){n.r(a),n.d(a,{default:()=>o});var s=n(555),t=n(43),i=n(292);const r=(0,n(784).A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var c=n(54),l=n(375),d=n(579);const o=()=>{const[e,a]=(0,t.useState)(""),[n,o]=(0,t.useState)([]),[h,g]=(0,t.useState)(!0),[u,m]=(0,t.useState)(null),[p,x]=(0,t.useState)({page:1,total:0,pages:0}),[j,v]=(0,t.useState)(20);(0,t.useEffect)(()=>{x(e=>(0,s.A)((0,s.A)({},e),{},{page:1}))},[e,j]),(0,t.useEffect)(()=>{y()},[p.page,e]);const y=async()=>{g(!0),m(null);try{const i=new URLSearchParams({page:p.page.toString(),limit:j.toString()});e&&i.append("search",e);const r=await fetch("".concat(l.JR).concat(l.Sn.ADMIN_AGENTS_LIST,"?").concat(i),{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"}),c=await r.text();if(!r.ok){var a,n,s;let e=null;try{e=JSON.parse(c)}catch(t){}throw new Error((null===(a=e)||void 0===a?void 0:a.message)||(null===(n=e)||void 0===n||null===(s=n.data)||void 0===s?void 0:s.message)||(401===r.status?"Authentication required. Please log in again.":403===r.status?"Access denied. Insufficient permissions.":500===r.status?"Server error. Please try again later.":"HTTP error! status: ".concat(r.status)))}let d;try{d=JSON.parse(c)}catch(t){throw console.error("Failed to parse JSON:",t),console.error("Response text:",c),new Error("Invalid JSON response from server: "+c.substring(0,200))}d.success?(o(d.data.agents||[]),x(d.data.pagination||{page:1,total:0,pages:0})):m(d.message||"Failed to load agents")}catch(i){console.error("Error fetching agents:",i),"TypeError"===i.name&&i.message.includes("fetch")?m("Network error. Please check your connection and ensure the backend server is running."):m(i.message||"Failed to load agents")}finally{g(!1)}};return(0,d.jsxs)("div",{className:"admin-agents",children:[(0,d.jsx)("div",{className:"admin-page-header",children:(0,d.jsxs)("div",{children:[(0,d.jsx)("h1",{children:"Agent / Builder Management"}),(0,d.jsx)("p",{children:h?"Loading...":"".concat(n.length," of ").concat(p.total," agents/builders")})]})}),(0,d.jsxs)("div",{className:"admin-filters-bar",children:[(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,d.jsx)("label",{style:{fontSize:"14px",color:"#64748b"},children:"Items per page:"}),(0,d.jsxs)("select",{value:j,onChange:e=>v(Number(e.target.value)),style:{padding:"6px 12px",border:"1px solid #e2e8f0",borderRadius:"6px",fontSize:"14px",cursor:"pointer"},children:[(0,d.jsx)("option",{value:10,children:"10"}),(0,d.jsx)("option",{value:20,children:"20"}),(0,d.jsx)("option",{value:50,children:"50"}),(0,d.jsx)("option",{value:100,children:"100"})]})]}),(0,d.jsxs)("div",{className:"admin-search-box",children:[(0,d.jsx)(i.A,{className:"admin-search-icon"}),(0,d.jsx)("input",{type:"text",placeholder:"Search agents...",value:e,onChange:e=>a(e.target.value),onKeyPress:e=>{"Enter"===e.key&&y()}}),(0,d.jsx)("button",{className:"admin-search-btn",onClick:y,children:"Search"})]})]}),(0,d.jsx)("div",{className:"admin-agents-table-container",children:h?(0,d.jsx)("div",{className:"admin-no-results",children:(0,d.jsx)("h3",{children:"Loading agents..."})}):u?(0,d.jsxs)("div",{className:"admin-no-results",children:[(0,d.jsx)("h3",{children:"Error"}),(0,d.jsx)("p",{children:u})]}):n.length>0?(0,d.jsxs)("table",{className:"admin-agents-table",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{children:"AGENT / BUILDER"}),(0,d.jsx)("th",{children:"ROLE"}),(0,d.jsx)("th",{children:"STATUS"}),(0,d.jsx)("th",{children:"INQUIRIES"}),(0,d.jsx)("th",{children:"PROPERTIES"}),(0,d.jsx)("th",{children:"ACTIONS"})]})}),(0,d.jsx)("tbody",{children:n.map(e=>{const a=e.agent_verified||!1;return(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{"data-label":"Agent",children:(0,d.jsxs)("div",{className:"admin-agent-cell",children:[(0,d.jsx)("div",{className:"admin-agent-avatar",children:(n=e.full_name,n?n.split(" ").map(e=>e[0]).join("").toUpperCase().substring(0,2):"A")}),(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"admin-agent-name",children:e.full_name||"N/A"}),(0,d.jsx)("div",{className:"admin-agent-email",children:e.email})]})]})}),(0,d.jsx)("td",{"data-label":"Role",children:(0,d.jsx)("span",{style:{padding:"4px 8px",borderRadius:"4px",background:"#06b6d420",color:"#06b6d4",fontSize:"12px",fontWeight:"500",textTransform:"capitalize"},children:"agent"===e.user_type?"Agent":"Builder"})}),(0,d.jsx)("td",{"data-label":"Status",children:(0,d.jsx)("span",{className:"admin-status-badge ".concat(a?"admin-verified":"admin-pending"),children:a?"Verified":"Pending"})}),(0,d.jsx)("td",{"data-label":"Inquiries",children:(0,d.jsx)("div",{className:"admin-leads-badge",children:e.leads_count||0})}),(0,d.jsx)("td",{"data-label":"Properties",children:(0,d.jsx)("div",{className:"admin-leads-badge",children:e.property_count||0})}),(0,d.jsx)("td",{"data-label":"Actions",className:"admin-actions-cell",children:(0,d.jsx)("div",{className:"admin-actions-wrapper",children:a?(0,d.jsxs)("button",{className:"admin-agent-action-btn admin-agent-unverify-btn",title:"Unverify Agent",onClick:()=>(async e=>{try{const a=await fetch("".concat(l.JR).concat(l.Sn.ADMIN_AGENTS_UNVERIFY,"?id=").concat(e),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"}),n=await a.json();n.success?y():alert(n.message||"Failed to unverify agent")}catch(a){console.error("Error unverifying agent:",a),alert("Failed to unverify agent")}})(e.id),children:[(0,d.jsx)(r,{size:18}),(0,d.jsx)("span",{children:"Unverify"})]}):(0,d.jsxs)("button",{className:"admin-agent-action-btn admin-agent-verify-btn",title:"Verify Agent",onClick:()=>(async e=>{try{const a=await fetch("".concat(l.JR).concat(l.Sn.ADMIN_AGENTS_VERIFY,"?id=").concat(e),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"}),n=await a.json();n.success?y():alert(n.message||"Failed to verify agent")}catch(a){console.error("Error verifying agent:",a),alert("Failed to verify agent")}})(e.id),children:[(0,d.jsx)(c.A,{size:18}),(0,d.jsx)("span",{children:"Verify"})]})})})]},e.id);var n})})]}):(0,d.jsxs)("div",{className:"admin-no-results",children:[(0,d.jsx)("h3",{children:"No agents found"}),(0,d.jsx)("p",{children:"Try adjusting your search"})]})})]})}}}]);
//# sourceMappingURL=566.b5eebba2.chunk.js.map